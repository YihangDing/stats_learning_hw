knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
x <- rnorm(100, 0, 1)
eps <- rnorm(100, 0, 0.25)
y <- -1 + 0.5*x + eps
plot(x,y,col="red")
lm1 <- lm(y~x)
summary(lm1)
lm1_pred <- predict(lm1)
plot(x, y, col="red", pch=20)
segments(x, y, x, lm1_pred)
abline(lm1, col="blue", lwd=2)
legend("topleft", inset=.01, c("point", "least square", "regression line"), lwd=2, col=c("red", "black", "blue"))
lm2 = lm(y~x+I(x^2))
summary(lm2)
x <- rnorm(100, 0, 1)
eps <- rnorm(100, 0, 0.1)
y <- -1 + 0.5*x + eps
plot(x,y,col="red")
lm3 <- lm(y~x)
summary(lm3)
lm3_pred <- predict(lm3)
plot(x, y, col="red", pch=20)
segments(x, y, x, lm3_pred)
abline(lm3, col="blue", lwd=2)
legend("topleft", inset=.01, c("point", "least square", "regression line"), lwd=2, col=c("red", "black", "blue"))
lm4 = lm(y~x+I(x^2))
summary(lm4)
x <- rnorm(100, 0, 1)
eps <- rnorm(100, 0, 0.5)
y <- -1 + 0.5*x + eps
plot(x,y,col="red")
lm5 <- lm(y~x)
summary(lm5)
lm5_pred <- predict(lm5)
plot(x, y, col="red", pch=20)
segments(x, y, x, lm5_pred)
abline(lm5, col="blue", lwd=2)
legend("topleft", inset=.01, c("point", "least square", "regression line"), lwd=2, col=c("red", "black", "blue"))
lm6 = lm(y~x+I(x^2))
summary(lm6)
confint(lm1)
confint(lm3)
confint(lm5)
Ad = read.csv("Advertising.csv", header=T, na.strings="?")
dim(Ad)
lm_ad_news = lm(Ad$sales~Ad$newspaper)
plot(Ad$newspaper,Ad$sales, col="red")
lm_ad_news = lm(Ad$sales~Ad$newspaper)
lm_ad_news_pred = predict(lm_ad_news, interval="confidence", level=0.92)
summary(lm_ad_news_pred)
plot(Ad$newspaper,Ad$sales, col="red", main="Sales~newspaper")
lines(Ad$newspaper, lm_ad_news_pred[,2], col="green")
abline(lm_ad_news, col="blue", lwd=2)
lines(Ad$newspaper, lm_ad_news_pred[,3], col="green")
lm_ad_tv = lm(Ad$sales~Ad$TV)
plot(Ad$TV,Ad$sales, col="red")
lm_ad_tv = lm(Ad$sales~Ad$TV)
lm_ad_tv_pred = predict(lm_ad_tv, interval="confidence", level=0.92)
summary(lm_ad_tv_pred)
plot(Ad$TV,Ad$sales, col="red", main="Sales~TV")
lines(Ad$TV, lm_ad_tv_pred[,2], col="green")
abline(lm_ad_tv, col="blue", lwd=2)
lines(Ad$TV, lm_ad_tv_pred[,3], col="green")
lm_ad_radio = lm(Ad$sales~Ad$radio)
plot(Ad$radio,Ad$sales, col="red")
lm_ad_radio = lm(Ad$sales~Ad$radio)
lm_ad_radio_pred = predict(lm_ad_radio, interval="confidence", level=0.92)
summary(lm_ad_radio_pred)
plot(Ad$radio,Ad$sales, col="red", main="Sales~Radio")
lines(Ad$radio, lm_ad_radio_pred[,2], col="green")
abline(lm_ad_radio, col="blue", lwd=2)
lines(Ad$radio, lm_ad_radio_pred[,3], col="green")
Auto = read.csv("Auto.csv", header=T, na.strings="?")
dim(Auto)
Auto[1:4,]
pairs(Auto, col="red")
selected = Auto[,1:8]
dim(selected)
cor(selected)
lm_mul = lm(Auto$mpg~Auto$cylinders+Auto$displacement+Auto$horsepower+Auto$weight+Auto$acceleration+Auto$year)
summary(lm_mul)
lm_mul2 = lm(Auto$mpg~sqrt(Auto$cylinders)+sqrt(Auto$displacement)+sqrt(Auto$horsepower)+sqrt(Auto$weight)+sqrt(Auto$acceleration)+sqrt(Auto$year))
summary(lm_mul2)
lm_mul3 = lm(Auto$mpg~I(Auto$cylinders^2)+I(Auto$displacement^2)+I(Auto$horsepower^2)+I(Auto$weight^2)+I(Auto$acceleration^2)+I(Auto$year^2))
summary(lm_mul3)
knitr::opts_chunk$set(echo = TRUE)
install.packages("basicTrendline")
library(basicTrendline)
trendline(Ad$sales, Ad$newspaper, Cl.level=0.92)
install.packages("basicTrendline")
library(basicTrendline)
trendline(Ad$sales, Ad$newspaper, CI.level＝0.92)
install.packages("basicTrendline")
install.packages("basicTrendline")
library(basicTrendline)
trendline(Ad$sales, Ad$newspaper, CI.level＝0.92)
knitr::opts_chunk$set(echo = TRUE)
Ad = read.csv("Advertising.csv", header=T, na.strings="?")
dim(Ad)
lm_ad_news = lm(Ad$sales~Ad$newspaper)
plot(Ad$newspaper,Ad$sales, col="red")
lm_ad_news = lm(Ad$sales~Ad$newspaper)
lm_ad_news_pred = predict(lm_ad_news, interval="confidence", level=0.92)
summary(lm_ad_news_pred)
install.packages("basicTrendline")
library(basicTrendline)
trendline(Ad$sales, Ad$newspaper, CI.level＝0.92)
install.packages("basicTrendline")
install.packages("basicTrendline")
library(basicTrendline)
trendline(Ad$sales, Ad$newspaper, CI.level＝0.92)
install.packages("basicTrendline")
library(basicTrendline)
trendline(Ad$sales, Ad$newspaper, CI.level=0.92)
trendline(Ad$sales, Ad$newspaper, CI.level=0.92)
trendline(Ad$sales, Ad$TV, CI.level=0.92)
trendline(Ad$sales, Ad$radio, CI.level=0.92)
